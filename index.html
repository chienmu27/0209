<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>å¯’è¨“ç¹³è²»æŸ¥è©¢</title>

<style>
:root{
  --bg1:#e9fff6;
  --bg2:#eaf3ff;
  --card:#ffffffcc;
  --line:#d9e6ff;
  --ink:#17324a;
  --muted:#5c728a;
  --green:#16a34a;
  --red:#ef4444;
  --shadow: 0 18px 50px rgba(15, 23, 42, .12);
  --radius: 18px;
}

*{ box-sizing:border-box; }

body{
  font-family: "Microsoft JhengHei", system-ui, -apple-system, sans-serif;
  margin:0;
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:22px;
  color:var(--ink);
  background:
    radial-gradient(900px 500px at 15% 10%, #ffffff 0%, transparent 55%),
    radial-gradient(900px 520px at 85% 20%, #ffffff 0%, transparent 55%),
    radial-gradient(700px 480px at 50% 90%, #d9fff0 0%, transparent 60%),
    linear-gradient(135deg, var(--bg1), var(--bg2));
  overflow-x:hidden;
}

/* èƒŒæ™¯å¯æ„›ç¾½çƒè£é£¾ */
.bg-deco{
  position:fixed;
  inset:0;
  pointer-events:none;
  opacity:.9;
}
.bg-deco::before,
.bg-deco::after{
  content:"";
  position:absolute;
  width:360px;
  height:360px;
  border-radius:50%;
  filter: blur(1px);
  opacity:.55;
}
.bg-deco::before{
  left:-90px;
  top:-90px;
  background: radial-gradient(circle at 30% 30%, #b7ffd8, transparent 60%);
}
.bg-deco::after{
  right:-120px;
  bottom:-120px;
  background: radial-gradient(circle at 35% 35%, #b9d7ff, transparent 62%);
}

.wrap{
  width:min(920px, 100%);
  display:flex;
  justify-content:center;
}

.card{
  width:min(760px, 100%);
  background:var(--card);
  backdrop-filter: blur(10px);
  border:1px solid rgba(120, 170, 255, .25);
  border-radius:var(--radius);
  box-shadow: var(--shadow);
  padding: 22px 18px 18px;
  position:relative;
  overflow:hidden;
}

/* å°ç¾½çƒæ¨™ç±¤ */
.badge-row{
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  justify-content:center;
  margin-bottom: 10px;
}

.badge{
  display:inline-flex;
  align-items:center;
  gap:8px;
  padding: 7px 12px;
  border-radius:999px;
  font-size:13px;
  color:#0b3a2a;
  background: linear-gradient(135deg, #d9fff0, #e9f2ff);
  border:1px solid rgba(40, 120, 255, .18);
  box-shadow: 0 8px 18px rgba(2, 6, 23, .06);
}

.badge .shuttle{
  width:18px;
  height:18px;
  display:inline-block;
  transform: rotate(-10deg);
}

/* æ¨™é¡Œ tab + ç¾½çƒå‹•ç•« */
.header{
  display:flex;
  align-items:center;
  justify-content:center;
  gap:14px;
  margin: 2px 0 14px;
  position:relative;
}

.tab{
  display:inline-flex;
  align-items:center;
  gap:10px;
  padding: 12px 18px;
  border-radius: 999px;
  background: linear-gradient(135deg, #ffffff, #eaf3ff);
  border: 1px solid rgba(80, 140, 255, .25);
  box-shadow: 0 14px 26px rgba(15, 23, 42, .08);
  position:relative;
  overflow:hidden;
}

.tab::after{
  content:"";
  position:absolute;
  inset:-40px;
  background: radial-gradient(circle at 30% 30%, rgba(180,255,220,.65), transparent 55%);
  opacity:.55;
}

h2{
  margin:0;
  font-size: 22px;
  letter-spacing:.5px;
  position:relative;
  z-index:1;
}

/* tab ç¾½çƒé£›è¡Œå‹•ç•« */
.fly-shuttle{
  width:26px;
  height:26px;
  position:relative;
  z-index:1;
  animation: tabFly 2.6s ease-in-out infinite;
  transform-origin:center;
}

@keyframes tabFly{
  0%   { transform: translateX(-2px) translateY(0px) rotate(-10deg); }
  50%  { transform: translateX(10px) translateY(-5px) rotate(12deg); }
  100% { transform: translateX(-2px) translateY(0px) rotate(-10deg); }
}

/* æ§åˆ¶å€ */
.controls{
  display:flex;
  flex-direction:column;
  gap:10px;
  align-items:center;
  justify-content:center;
  padding: 10px 0 12px;
}

label{
  font-size: 15px;
  color: var(--muted);
}

select{
  width: min(360px, 92%);
  font-size: 16px;
  padding: 12px 14px;
  border-radius: 14px;
  border:1px solid rgba(80, 140, 255, .25);
  background: rgba(255,255,255,.95);
  outline:none;
  box-shadow: 0 10px 20px rgba(2, 6, 23, .06);
  transition: transform .15s ease, box-shadow .15s ease;
}

select:focus{
  transform: translateY(-1px);
  box-shadow: 0 16px 26px rgba(2, 6, 23, .10);
}

/* ç¹³è²»ç‹€æ…‹ */
#payStatus{
  margin: 2px 0 6px;
  font-size: 20px;
  font-weight: 900;
  letter-spacing:1px;
  padding: 10px 14px;
  border-radius: 14px;
  min-width: min(360px, 92%);
  text-align:center;
  border:1px solid rgba(80, 140, 255, .20);
  background: rgba(255,255,255,.75);
  box-shadow: 0 12px 26px rgba(2, 6, 23, .06);
}

/* è¡¨æ ¼ */
.tableWrap{
  margin-top: 10px;
  border-radius: 18px;
  overflow:hidden;
  border:1px solid rgba(80, 140, 255, .18);
  background: rgba(255,255,255,.9);
  box-shadow: 0 18px 34px rgba(2, 6, 23, .08);
}

table{
  width:100%;
  border-collapse: collapse;
}

th, td{
  border-bottom: 1px solid rgba(80, 140, 255, .14);
  padding: 12px 10px;
  text-align:center;
  font-size: 15px;
}

th{
  background: linear-gradient(135deg, #f6fbff, #eaf3ff);
  color:#1d3c58;
  font-weight: 800;
}

tbody tr{
  transition: transform .12s ease, background .12s ease;
}
tbody tr:hover{
  background: rgba(185, 255, 220, .18);
  transform: translateY(-1px);
}

/* ç¾½çƒæŒ‰éˆ• hover é£›ç¿”æ•ˆæœï¼ˆé›–ç„¶æ­¤é é¢æ²’æœ‰æŒ‰éˆ•ï¼Œä½†æˆ‘ä»åŠ ä¸Šå¯ç›´æ¥ç”¨ï¼‰ */
.btn{
  position:relative;
  display:inline-flex;
  align-items:center;
  gap:10px;
  padding: 11px 16px;
  border-radius: 16px;
  border: 1px solid rgba(80, 140, 255, .25);
  background: linear-gradient(135deg, #ffffff, #eaf3ff);
  color: var(--ink);
  font-weight: 800;
  cursor:pointer;
  box-shadow: 0 16px 26px rgba(2, 6, 23, .08);
  transition: transform .15s ease, box-shadow .15s ease;
  overflow:hidden;
}

.btn:hover{
  transform: translateY(-2px);
  box-shadow: 0 20px 34px rgba(2, 6, 23, .12);
}

.btn .shuttle{
  width:18px;
  height:18px;
  display:inline-block;
}

.btn::after{
  content:"";
  position:absolute;
  width:34px;
  height:34px;
  right: 14px;
  top: 50%;
  transform: translateY(-50%) translateX(30px) rotate(-12deg);
  background:
    radial-gradient(circle at 30% 30%, rgba(255,255,255,.95), rgba(255,255,255,.1) 60%),
    radial-gradient(circle at 70% 70%, rgba(185, 255, 220, .8), transparent 60%);
  border-radius: 50%;
  opacity:0;
}

.btn:hover::after{
  animation: shuttleTrail .75s ease-out 1;
  opacity:1;
}

@keyframes shuttleTrail{
  0%   { transform: translateY(-50%) translateX(40px) scale(.6); opacity:0; }
  30%  { opacity:1; }
  100% { transform: translateY(-50%) translateX(-120px) scale(1.15); opacity:0; }
}

/* æ‰‹æ©Ÿç‰ˆ */
@media (max-width: 520px){
  h2{ font-size: 20px; }
  th, td{ font-size: 14px; padding: 11px 8px; }
}
</style>
</head>

<body>
<div class="bg-deco"></div>

<div class="wrap">
  <div class="card">

    <div class="badge-row">
      <div class="badge">
        <svg class="shuttle" viewBox="0 0 64 64" aria-hidden="true">
          <path d="M32 6c6 7 10 15 10 22 0 9-7 16-10 16s-10-7-10-16c0-7 4-15 10-22z" fill="#ffffff"/>
          <path d="M20 28c-7 2-12 6-12 10 0 7 11 13 24 13s24-6 24-13c0-4-5-8-12-10" fill="rgba(185,255,220,.9)"/>
          <path d="M24 49l8 9 8-9" fill="rgba(80,140,255,.25)"/>
          <path d="M32 58v-7" stroke="rgba(23,50,74,.35)" stroke-width="2" stroke-linecap="round"/>
        </svg>
        Badminton å†¬è¨“
      </div>

      <div class="badge">
        ğŸ¸ å¯æ„›é‹å‹•é¢¨
      </div>

      <div class="badge">
        è®€å– Google è©¦ç®—è¡¨è³‡æ–™
      </div>
    </div>

    <div class="header">
      <div class="tab">
        <svg class="fly-shuttle" viewBox="0 0 64 64" aria-hidden="true">
          <path d="M32 6c6 7 10 15 10 22 0 9-7 16-10 16s-10-7-10-16c0-7 4-15 10-22z" fill="#ffffff"/>
          <path d="M20 28c-7 2-12 6-12 10 0 7 11 13 24 13s24-6 24-13c0-4-5-8-12-10" fill="rgba(185,255,220,.9)"/>
          <path d="M24 49l8 9 8-9" fill="rgba(80,140,255,.25)"/>
          <path d="M32 58v-7" stroke="rgba(23,50,74,.35)" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <h2>ç¹³è²»æŸ¥è©¢</h2>
      </div>
    </div>

    <div class="controls">
      <label>é¸æ“‡å­¸ç”Ÿ</label>
      <select id="studentSelect">
        <option value="">--è«‹é¸æ“‡--</option>
      </select>
      <div id="payStatus"></div>
    </div>

    <div class="tableWrap">
      <table id="resultTable">
        <thead></thead>
        <tbody></tbody>
      </table>
    </div>

  </div>
</div>

<script>
// ====== CSV é€£çµï¼ˆGitHub Pages å¯ç›´æ¥è®€å–ï¼‰======
const csvUrl =
  "https://docs.google.com/spreadsheets/d/e/2PACX-1vS0tI5Jlr-JGfZEZ1_DBIQQ-bTZ1g1I6uggZj7J3ZhgF5wQiv1EP2HI96CbC4o6CpsFWAeVB9A2SYm7/pub?gid=0&single=true&output=csv";

let rows = [];
let header = [];

// ====== CSV è§£æ ======
function parseCSV(text) {
  const result = [];
  let cur = [];
  let curVal = "";
  let inQuotes = false;

  for (let i = 0; i < text.length; i++) {
    const ch = text[i];
    const next = text[i + 1];

    if (inQuotes) {
      if (ch === '"' && next === '"') {
        curVal += '"';
        i++;
      } else if (ch === '"') {
        inQuotes = false;
      } else {
        curVal += ch;
      }
    } else {
      if (ch === '"') {
        inQuotes = true;
      } else if (ch === ',') {
        cur.push(curVal);
        curVal = "";
      } else if (ch === '\n') {
        cur.push(curVal);
        result.push(cur);
        cur = [];
        curVal = "";
      } else if (ch !== '\r') {
        curVal += ch;
      }
    }
  }
  if (curVal !== "" || cur.length > 0) {
    cur.push(curVal);
    result.push(cur);
  }
  return result;
}

// ====== è¼‰å…¥ CSV ======
async function loadCSV() {
  const res = await fetch(csvUrl);
  const text = await res.text();
  const parsed = parseCSV(text);

  rows = parsed.filter(r => r.some(c => c && String(c).trim() !== ""));
  header = rows[0];

  buildStudentDropdown();
}

// ====== å»ºç«‹å­¸ç”Ÿé¸å–®ï¼ˆæ”¹ç‚º A2:Aï¼‰ ======
function buildStudentDropdown() {
  const set = new Set();

  // Aæ¬„ = index 0ï¼Œå¾ç¬¬2åˆ—é–‹å§‹
  rows.slice(1).forEach(r => {
    const name = String(r[0] ?? "").trim();
    if (name) set.add(name);
  });

  const select = document.getElementById("studentSelect");
  select.innerHTML = '<option value="">--è«‹é¸æ“‡--</option>';

  [...set].sort().forEach(name => {
    const op = document.createElement("option");
    op.value = name;
    op.textContent = name;
    select.appendChild(op);
  });
}

// ====== ç¯©é¸å­¸ç”Ÿè³‡æ–™ï¼ˆä¾æ¬„ä½åç¨±ï¼šå§“åï¼‰ ======
function filterData(studentName) {
  const idxName = header.indexOf("å§“å");
  if (idxName === -1) return [];
  return rows.slice(1).filter(r => String(r[idxName] ?? "").trim() === studentName);
}

// ====== ç¹³è²»ç‹€æ…‹åˆ¤æ–· ======
function renderPayStatus(data) {
  const statusDiv = document.getElementById("payStatus");
  statusDiv.textContent = "";

  const payIdx = header.indexOf("ç¹³è²»æƒ…æ³");
  if (payIdx === -1) return;

  const hasPaid = data.some(r => String(r[payIdx] ?? "").trim() === "å·²ç¹³è²»");
  statusDiv.textContent = hasPaid ? "å·²ç¹³è²»" : "æœªç¹³è²»";

  // ç‹€æ…‹é¡è‰²ï¼ˆä¸æ”¹åŠŸèƒ½ï¼Œåªæ˜¯è¦–è¦ºï¼‰
  if (hasPaid) {
    statusDiv.style.color = "#16a34a";
  } else {
    statusDiv.style.color = "#ef4444";
  }
}

// ====== é¡¯ç¤ºè¡¨æ ¼ï¼ˆå§“åã€é …ç›®ã€ç¹³è²»æƒ…æ³ï¼‰ ======
function renderTable(data) {
  const thead = document.querySelector("#resultTable thead");
  const tbody = document.querySelector("#resultTable tbody");
  thead.innerHTML = "";
  tbody.innerHTML = "";

  if (data.length === 0) {
    tbody.innerHTML = `<tr><td colspan="3">æ²’æœ‰æ‰¾åˆ°è³‡æ–™</td></tr>`;
    return;
  }

  const idxName = header.indexOf("å§“å");
  const idxType = header.indexOf("é¡åˆ¥");     // é¡¯ç¤ºç‚ºã€Œé …ç›®ã€
  const idxPay  = header.indexOf("ç¹³è²»æƒ…æ³");

  thead.innerHTML = `
    <tr>
      <th>å§“å</th>
      <th>é …ç›®</th>
      <th>ç¹³è²»æƒ…æ³</th>
    </tr>
  `;

  data.forEach(r => {
    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${r[idxName] ?? ""}</td>
      <td>${r[idxType] ?? ""}</td>
      <td>${r[idxPay] ?? ""}</td>
    `;
    tbody.appendChild(tr);
  });
}

// ====== ä¸‹æ‹‰é¸å–®ç›£è½ ======
document.getElementById("studentSelect").addEventListener("change", e => {
  const student = e.target.value;
  const data = filterData(student);

  renderPayStatus(data);
  renderTable(data);
});

// ====== åˆå§‹åŒ– ======
loadCSV();
</script>

</body>
</html>
